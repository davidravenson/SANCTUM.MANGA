<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SANCTUM — Chapter 1</title>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #000;
      color: #fff;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }

    /* ===== PANEL / READER ===== */
    .wrap {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
    }

    .panel {
      max-width: 900px;
      width: 100%;
      border: 1px solid rgba(255,255,255,.25);
      background: #000;
    }

    .panel img {
      width: 100%;
      height: auto;
      display: block;
      user-select: none;
      -webkit-user-drag: none;
    }

    /* ===== AUDIO PLAYER (FIXIERT, IMMER SICHTBAR) ===== */
    #bgAudio {
      position: fixed;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      z-index: 9999;

      width: 150px;
      max-width: 42vw;

      background: rgba(0,0,0,.65);
      border-radius: 18px;
      padding: 10px;

      box-shadow: 0 0 0 1px rgba(255,255,255,.2);
      backdrop-filter: blur(6px);
    }

    /* Mobile: unten */
    @media (max-width: 720px) {
      #bgAudio {
        top: auto;
        bottom: 12px;
        left: 12px;
        right: 12px;
        width: auto;
        transform: none;
      }
    }
  </style>
</head>

<body>

  <div class="wrap">
    <div class="panel">
      <!-- Panel Bild -->
      <img
        src="./manga/my-series/chapter-1/001.jpg"
        alt="SANCTUM Panel 001">
    </div>
  </div>

  <!-- AUDIO -->
  <audio
    id="bgAudio"
    src="./audio/sanctum_ch1_arcangel_instrumental.mp3"
    preload="auto"
    playsinline
    controls
    controlsList="nodownload noplaybackrate">
  </audio>

  <!-- SCRIPT -->
  <script>
    const audio = document.getElementById('bgAudio');

    const FADE_MS = 2500;
    const TARGET_VOL = 0.45;

    // Native Controls bleiben, Download raus
    audio.controls = true;
    audio.volume = 0;

    // Rechtsklick unterdrücken (soft barrier)
    document.addEventListener('contextmenu', e => e.preventDefault());

    function fadeIn() {
      let start = null;

      function step(ts) {
        if (!start) start = ts;
        const p = Math.min((ts - start) / FADE_MS, 1);
        audio.volume = p * TARGET_VOL;
        if (p < 1) requestAnimationFrame(step);
      }

      requestAnimationFrame(step);
    }

    // Autostart versuchen
    window.addEventListener('load', async () => {
      try {
        await audio.play();
        fadeIn();
      } catch (e) {
        // Autoplay blockiert → User klickt Play
      }
    });

    // Wenn User manuell startet → Fade trotzdem sauber
    audio.addEventListener('play', () => {
      if (audio.volume < TARGET_VOL * 0.9) {
        audio.volume = 0;
        fadeIn();
      }
    });
  </script>

</body>
</html>