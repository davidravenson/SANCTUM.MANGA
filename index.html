<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>SANCTUM â€” Reader</title>

  <style>
    :root{
      --v: "v0.30.6";
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);

      --bg: url("./media/ui/manga_paper_bg.png");
      --shadow: 0 16px 40px rgba(0,0,0,.35);

      --dock-overlap: -78px;

      --player-expanded-w: min(96vw, 720px);
      --player-expanded-h: 190px;

      /* Breite der linken SC-Zone (Play + Artwork) */
      --sc-left-mask-w: 96px;
    }

    html, body{
      height:100%;
      margin:0;
      background:#000;
      color:#fff;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      -webkit-tap-highlight-color: transparent;
      overflow-x:hidden;
    }

    body{
      background-image: var(--bg);
      background-size: cover;
      background-position: center top;
      background-repeat: no-repeat;
      background-attachment: fixed;
      overscroll-behavior: none;
      touch-action: pan-y;
    }

    .page{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    .stage{
      position:relative;
      width:100%;
      max-width: 860px;
      padding-top: calc(8px + var(--safe-top));
      padding-bottom: 16px;
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .panelShell{
      position:relative;
      width:100%;
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .panelImg{
      width: min(100vw, 860px);
      height: auto;
      display:block;
      background:#000;
    }

    .playerDock{
      position:absolute;
      left:50%;
      bottom: var(--dock-overlap);
      transform: translateX(-50%);
      z-index:20;
    }

    .player{
      position:relative;
      width:78px;
      height:78px;
      border-radius:999px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      transition: width .28s ease, height .28s ease, border-radius .28s ease;
    }

    .player .embedWrap{ display:none; }

    .playerBtn{
      width:100%;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      z-index:5;
      position:relative;
    }

    .playIcon{
      width:0;
      height:0;
      border-top:12px solid transparent;
      border-bottom:12px solid transparent;
      border-left:18px solid rgba(255,255,255,.92);
      transform: translateX(2px);
    }

    .player.expanded{
      width: var(--player-expanded-w);
      height: var(--player-expanded-h);
      border-radius:22px;
      background: rgba(255,255,255,.12);
    }

    .player.expanded .embedWrap{ display:block; }

    .player.expanded .playerBtn{
      position:absolute;
      left:10px;
      top:10px;
      width:54px;
      height:54px;
      border-radius:999px;
      background: rgba(0,0,0,.26);
      border:1px solid rgba(255,255,255,.18);
    }

    .embedWrap{
      position:absolute;
      inset:10px;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
    }

    .embedWrap iframe{
      width:100%;
      height:100%;
      border:0;
    }

    /* ðŸ”’ MASKIERT den linken SoundCloud-Playbutton NUR wenn expanded */
    .player.expanded::before{
      content:"";
      position:absolute;
      left:10px;
      top:10px;
      bottom:10px;
      width: var(--sc-left-mask-w);
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(6px);
      border-radius:14px;
      z-index:4;
      pointer-events:none;
    }

  </style>
</head>

<body>

<div class="page">
  <div class="stage">
    <div class="panelShell">
      <img class="panelImg" src="./manga/chapter-00/panel01.jpg" alt="Panel 01">

      <div class="playerDock">
        <div id="player" class="player">
          <div id="playerBtn" class="playerBtn">
            <div class="playIcon"></div>
          </div>

          <div class="embedWrap">
            <iframe
              id="scFrame"
              allow="autoplay"
              scrolling="no"
              src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/user-543596862/sentinel-2&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=false&visual=false">
            </iframe>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script src="https://w.soundcloud.com/player/api.js"></script>
<script>
(() => {
  const player = document.getElementById("player");
  const btn = document.getElementById("playerBtn");
  const frame = document.getElementById("scFrame");

  let widget = SC.Widget(frame);
  let playing = false;

  widget.bind(SC.Widget.Events.PLAY, () => playing = true);
  widget.bind(SC.Widget.Events.PAUSE, () => playing = false);
  widget.bind(SC.Widget.Events.FINISH, () => {
    playing = false;
    player.classList.remove("expanded");
  });

  btn.addEventListener("click", () => {
    if(!player.classList.contains("expanded")){
      player.classList.add("expanded");
      widget.play();
    } else {
      playing ? widget.pause() : widget.play();
    }
  });
})();
</script>

</body>
</html>